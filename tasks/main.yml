---

- name: install packages
  yum: pkg={{ item }} state=present
  with_items:
    - GeoIP

- block:
  - name: install geoipupdate
    yum: pkg={{ item }} state=present
    with_items:
      - geoipupdate
      - geoipupdate-cron
  when: ansible_distribution == 'CentOS' and ansible_distribution_major_version == '6'

- block:
  - name: install geoipupdate
    yum: pkg={{ item }} state=present
    with_items:
      - GeoIP-update
  when: ansible_distribution == 'CentOS' and ansible_distribution_major_version == '7'

- name: copy config
  template:
    src=GeoIP.conf.j2
    dest=/etc/GeoIP.conf
    backup=yes
  notify: run geoipupdate
